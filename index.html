<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Access Granted ðŸ’Œ</title>
  <style>
    :root { --bg:#0b0b10; --card:#141420; --txt:#f2f2f7; --muted:#b7b7c7; --accent:#ff4d7d; --ok:#35d07f; --bad:#ff5c5c; }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; display:grid; place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 700px at 20% 10%, rgba(255,77,125,.20), transparent 55%),
                  radial-gradient(900px 600px at 80% 70%, rgba(111,76,255,.18), transparent 55%),
                  var(--bg);
      color:var(--txt); padding:24px;
    }
    .wrap{width:min(680px, 100%);}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:22px;
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
    }
    .top{
      display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap;
      margin-bottom:14px;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px;
      background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.10);
      color:var(--muted); font-size:13px;
    }
    .pill b{color:var(--txt)}
    .bar{height:8px; background:rgba(255,255,255,.06); border-radius:999px; overflow:hidden; border:1px solid rgba(255,255,255,.08)}
    .bar > div{height:100%; width:0%; background:linear-gradient(90deg, var(--accent), #7b61ff); transition:width .35s ease}
    h1{margin:10px 0 8px; font-size:22px}
    p{margin:0 0 14px; color:var(--muted); line-height:1.45}
    .q{
      margin-top:14px;
      padding:16px;
      border-radius:14px;
      background:rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.08);
    }
    .q h2{margin:0 0 8px; font-size:18px}
    .hint{font-size:13px; color:rgba(242,242,247,.75); margin-top:8px}
    .row{display:flex; gap:10px; margin-top:12px; flex-wrap:wrap}
    input{
      flex:1;
      min-width:220px;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      color:var(--txt);
      outline:none;
    }
    input:focus{border-color: rgba(255,77,125,.55); box-shadow:0 0 0 4px rgba(255,77,125,.15)}
    button{
      padding:12px 14px;
      border:none;
      border-radius:12px;
      cursor:pointer;
      color:var(--txt);
      background: linear-gradient(90deg, var(--accent), #7b61ff);
      font-weight:700;
    }
    button.secondary{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color:var(--muted);
      font-weight:600;
    }
    .msg{
      margin-top:12px;
      padding:10px 12px;
      border-radius:12px;
      display:none;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color:var(--muted);
    }
    .msg.ok{display:block; border-color: rgba(53,208,127,.35); background: rgba(53,208,127,.10); color: rgba(235,255,245,.95)}
    .msg.bad{display:block; border-color: rgba(255,92,92,.35); background: rgba(255,92,92,.10); color: rgba(255,235,235,.95)}
    .final{
      text-align:center;
      padding:18px;
    }
    .heart{
      font-size:40px;
      filter: drop-shadow(0 10px 20px rgba(255,77,125,.25));
      animation: float 2.2s ease-in-out infinite;
    }
    @keyframes float{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }
    .btnRow{display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:14px}
    a.small{color:rgba(242,242,247,.7); font-size:12px; text-decoration:none}
    a.small:hover{color:rgba(242,242,247,.9)}

    /* --- Password lock overlay --- */
    .lock {
      position:fixed;
      inset:0;
      background: var(--bg);
      display:grid;
      place-items:center;
      z-index:9999;
      padding:24px;
    }
    .lockCard{
      width:min(380px, 100%);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:22px;
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
      text-align:center;
    }
    .lockCard h2{margin:0 0 6px; font-size:20px}
    .lockCard p{margin:0 0 12px; color:var(--muted)}
    .lockCard input{
      width:100%;
      min-width:unset;
    }
    .lockErr{min-height:18px; margin-top:10px; color: rgba(255,235,235,.95)}
  </style>
</head>
<body>

  <!-- Password Lock Screen -->
  <div id="lockScreen" class="lock">
    <div class="lockCard">
      <h2>Private Access ðŸ’Œ</h2>
      <p>Enter the secret password to continue</p>
      <input id="passwordInput" type="password" placeholder="passwordâ€¦" autocomplete="off" />
      <div class="row" style="justify-content:center; margin-top:12px;">
        <button type="button" onclick="unlockSite()">Unlock</button>
      </div>
      <div id="lockMsg" class="lockErr"></div>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="pill">Phase <b id="phaseNum">1</b> / <b id="phaseTotal">3</b></div>
        <div class="pill">Status: <b id="statusTxt">Locked ðŸ”’</b></div>
      </div>
      <div class="bar" aria-label="progress"><div id="progress"></div></div>

      <div id="content"></div>

      <div style="margin-top:14px; display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;">
        <button class="secondary" id="resetBtn" type="button">Reset</button>
        <a class="small" href="#" id="saveHint">Tip: Your progress is saved on this device.</a>
      </div>
    </div>
  </div>

  <script>
    // ðŸ” SET YOUR PASSWORD HERE (change this)
    const SITE_PASSWORD = "coolcoolcool";

    function unlockSite(){
      const inputEl = document.getElementById("passwordInput");
      const msgEl = document.getElementById("lockMsg");
      const v = (inputEl.value ?? "").toString();

      if(v === SITE_PASSWORD){
        document.getElementById("lockScreen").style.display = "none";
        msgEl.textContent = "";
        inputEl.value = "";
      } else {
        msgEl.textContent = "Wrong password ðŸ˜ˆ";
        inputEl.focus();
        inputEl.select();
      }
    }

    // Allow Enter key on password screen
    document.addEventListener("keydown", (e) => {
      if(document.getElementById("lockScreen").style.display !== "none" && e.key === "Enter"){
        unlockSite();
      }
    });

    // âœ… EDIT YOUR QUESTIONS + ANSWERS HERE
    const stages = [
      {
        title: "Checkpoint 1",
        prompt: "Whatâ€™s our secret nickname for each other? (lowercase is fine)",
        hint: "Itâ€™s the one you always use in texts ðŸ‘€",
        answer: ["babe", "bb"]
      },
      {
        title: "Checkpoint 2",
        prompt: "Where did we first meet? (one word is enough)",
        hint: "Think location, not the date.",
        answer: (val) => val.includes("campus") || val.includes("mmu")
      },
      {
        title: "Checkpoint 3",
        prompt: "Finish this sentence: â€œYou + me = ____â€",
        hint: "Cheesy answer accepted ðŸ˜­",
        answer: ["forever", "us", "love"]
      }
    ];

    const els = {
      phaseNum: document.getElementById("phaseNum"),
      phaseTotal: document.getElementById("phaseTotal"),
      statusTxt: document.getElementById("statusTxt"),
      progress: document.getElementById("progress"),
      content: document.getElementById("content"),
      resetBtn: document.getElementById("resetBtn"),
    };

    const STORAGE_KEY = "valentine_quiz_gate_v1";
    const state = loadState();

    els.phaseTotal.textContent = stages.length.toString();

    function loadState(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return { step: 0 };
        const parsed = JSON.parse(raw);
        if(typeof parsed.step !== "number") return { step: 0 };
        return { step: Math.max(0, Math.min(stages.length, parsed.step)) };
      }catch(e){ return { step: 0 }; }
    }
    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }
    function normalize(s){
      return (s ?? "").toString().trim().toLowerCase().replace(/\s+/g," ");
    }

    function isCorrect(stage, userInput){
      const v = normalize(userInput);

      if(typeof stage.answer === "function"){
        return !!stage.answer(v);
      }
      if(Array.isArray(stage.answer)){
        return stage.answer.map(normalize).includes(v);
      }
      return normalize(stage.answer) === v;
    }

    function render(){
      const done = state.step >= stages.length;
      const phase = Math.min(state.step, stages.length - 1);

      els.phaseNum.textContent = (done ? stages.length : (phase + 1)).toString();
      const pct = Math.round((state.step / stages.length) * 100);
      els.progress.style.width = pct + "%";
      els.statusTxt.textContent = done ? "Access Granted âœ…" : "Locked ðŸ”’";

      if(done){
        els.content.innerHTML = `
          <div class="final">
            <div class="heart">ðŸ’˜</div>
            <h1>Okayâ€¦ you passed everything ðŸ˜­</h1>
            <p>So I have one last question for youâ€¦</p>
            <h1 style="font-size:26px; margin-top:6px;">Will you be my Valentine?</h1>
            <div class="btnRow">
              <button type="button" onclick="celebrate()">YES ðŸ’–</button>
              <button type="button" class="secondary" onclick="tease()">no</button>
            </div>
            <p id="finalMsg" style="margin-top:12px;"></p>
          </div>
        `;
        return;
      }

      const stage = stages[phase];
      els.content.innerHTML = `
        <h1>Valentine Verification Portal ðŸ’Œ</h1>
        <p>Answer correctly to unlock the next phase.</p>

        <div class="q">
          <h2>${escapeHtml(stage.title)}</h2>
          <p style="margin:0;">${escapeHtml(stage.prompt)}</p>

          <div class="row">
            <input id="answerInput" placeholder="type your answerâ€¦" autocomplete="off" />
            <button id="submitBtn" type="button">Submit</button>
          </div>

          <div class="hint">Hint: ${escapeHtml(stage.hint || "No hint for this one ðŸ˜Œ")}</div>

          <div id="msg" class="msg"></div>
        </div>
      `;

      const input = document.getElementById("answerInput");
      const msg = document.getElementById("msg");
      const submit = document.getElementById("submitBtn");

      function attempt(){
        const val = input.value;
        if(!val.trim()){
          msg.className = "msg bad";
          msg.textContent = "Type something first ðŸ˜­";
          return;
        }
        if(isCorrect(stage, val)){
          msg.className = "msg ok";
          msg.textContent = "Correct âœ… Unlocking next phaseâ€¦";
          state.step += 1;
          saveState();
          setTimeout(render, 550);
        }else{
          msg.className = "msg bad";
          msg.textContent = "Nope ðŸ˜ˆ try again.";
          input.select();
        }
      }

      submit.addEventListener("click", attempt);
      input.addEventListener("keydown", (e)=>{ if(e.key === "Enter") attempt(); });
      input.focus();
    }

    function escapeHtml(str){
      return (str ?? "").toString()
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    els.resetBtn.addEventListener("click", ()=>{
      localStorage.removeItem(STORAGE_KEY);
      state.step = 0;
      render();
    });

    window.celebrate = function(){
      const el = document.getElementById("finalMsg");
      el.textContent = "YAYYYYY ðŸ’ž Iâ€™m taking you out. (No refunds.)";
      confettiBurst();
    }
    window.tease = function(){
      const el = document.getElementById("finalMsg");
      el.textContent = "Wrong button bestie ðŸ˜­ try again.";
    }

    function confettiBurst(){
      for(let i=0;i<80;i++){
        const s = document.createElement("span");
        s.textContent = ["âœ¨","ðŸ’–","ðŸ’˜","ðŸŒ¸","â­ï¸"][Math.floor(Math.random()*5)];
        s.style.position="fixed";
        s.style.left=(Math.random()*100)+"vw";
        s.style.top="-10px";
        s.style.fontSize=(12+Math.random()*18)+"px";
        s.style.pointerEvents="none";
        s.style.transition="transform 1.6s ease, opacity 1.6s ease";
        document.body.appendChild(s);
        const dx = (Math.random()*2-1)*180;
        const dy = 700 + Math.random()*400;
        requestAnimationFrame(()=>{
          s.style.transform=`translate(${dx}px, ${dy}px) rotate(${Math.random()*360}deg)`;
          s.style.opacity="0";
        });
        setTimeout(()=>s.remove(), 1700);
      }
    }

    render();
  </script>
</body>
</html>
